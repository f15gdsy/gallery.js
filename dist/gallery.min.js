!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.Gallery=i()}(this,function(){"use strict";var t=function(t){for(var i=arguments,e=1;e<arguments.length;e++){var n=i[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},i={getEl:function(t){if("string"==typeof t)return document.querySelector(t);if(t.tagName)return t;throw new TypeError("Gallery.js: Invalid elOrSelector")},getImgs:function(t){if(!Array.isArray(t))throw new TypeError("Gallery.js: Invalid imgs");return t},checkOpts:function(t){if("left"!==t.direction&&"right"!==t.direction&&"top"!==t.direction&&"down"!==t.direction)throw new Error("Gallery.js: Invalid direction",this.opts.direction)}},e={direction:"left",imgWidth:100,imgHeight:100,imgAlignX:.5,imgAlignY:.5,gapX:0,gapY:0,duration:10},n=function(n,o,r){this.el=i.getEl(n),this.imgs=i.getImgs(o),this.opts=t({},e,r),i.checkOpts(this.opts),this.refresh()},o={_isHorizonal:{},_isVertical:{},_dominantSize:{}};return n.prototype.start=function(){this.el.style.animationName=this.animName},n.prototype.stop=function(){this.el.style.animationName=""},n.prototype.refresh=function(){this.styleEl&&document.head.removeChild(this.styleEl),this._combineImgs(),this._createRule()},n.prototype.destroy=function(){document.head.removeChild(this.styleEl)},n.prototype._drawImg=function(t,i,e){var n=this;return new Promise(function(o,r){var s=new Image;s.src=i,s.onload=function(){var i,r,a,h,l,p,c=n.opts.imgWidth,d=n.opts.imgHeight,g=s.width/s.height,m=c/d;g<m?(a=s.width,h=s.width/m,i=0,r=(s.height-h)*n.opts.imgAlignY/100):(a=s.height*m,h=s.height,i=(s.width-a)*n.opts.imgAlignX,r=0);n.opts.direction;n._isHorizonal?(l=e*c+(e+1)*n.opts.gapX,p=0):(l=0,p=e*d+(e+1)*n.opts.gapY),t.drawImage(s,i,r,a,h,l,p,c,d),o()},s.onerror=r})},n.prototype._combineImgs=function(){var t=this,i=document.createElement("canvas");this.opts.direction;this._isHorizonal?(i.width=this._dominantSize,i.height=this.opts.imgHeight):(i.width=this.opts.imgWidth,i.height=this._dominantSize);var e=i.getContext("2d");Promise.all(this.imgs.map(function(i,n){return t._drawImg(e,i,n)})).then(function(){var e=i.toDataURL("image/jpeg");t.el.style.backgroundImage="url("+e+")"})},n.prototype._createRule=function(){var t=document.createElement("style");document.head.appendChild(t),this.styleEl=t;var i=t.sheet,e="gallery-"+this.opts.direction+"-"+this._dominantSize;this.animName=e,this.el.style.animationName=e,this.el.style.animationIterationCount="infinite",this.el.style.animationDuration=this.opts.duration+"s",this.el.style.animationTimingFunction="linear",this._isHorizonal?(this.el.style.backgroundRepeatX="repeat",this.el.style.backgroundRepeatY="no-repeat"):(this.el.style.backgroundRepeatX="no-repeat",this.el.style.backgroundRepeatY="repeat"),i.insertRule("\n      @keyframes "+e+" {\n        from {\n          background-position: 0 0;\n        }\n        to {\n          background-position: "+this._getAnimToData()+";\n        }\n      }\n    ",0)},n.prototype._getAnimToData=function(){var t=this._dominantSize;switch(this.opts.direction){case"left":return"-"+t+"px 0";case"right":return t+"px 0";case"top":return"0 "+t+"px";case"down":return"0 -"+t+"px"}},o._isHorizonal.get=function(){return"left"===this.opts.direction||"right"===this.opts.direction},o._isVertical.get=function(){return"top"===this.opts.direction||"down"===this.opts.direction},o._dominantSize.get=function(){this.opts.direction;return this._isHorizonal?this.imgs.length*(this.opts.imgWidth+this.opts.gapX):this.imgs.length*(this.opts.imgHeight+this.opts.gapY)},Object.defineProperties(n.prototype,o),n});
